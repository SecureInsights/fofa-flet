# FOFA API 图形界面工具

[![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://www.python.org/)
[![Flet](https://img.shields.io/badge/Flet-0.24.0+-green.svg)](https://flet.dev/)
一个基于 Python 和 Flet 框架开发的 FOFA API 图形界面工具，提供友好直观的用户界面，支持批量查询、数据导出和字段选择等功能。

## 🌟 主要特性

- **🖥️ 图形化界面** - 基于 Flet 框架的现代化桌面应用
- **🔐 安全存储** - API 密钥加密存储，保护隐私安全
- **🔍 智能查询** - 支持 FOFA 语法查询和字段选择
- **📊 批量处理** - 批量查询预览和导出功能
- **📁 数据导出** - CSV 格式导出，包含时间戳和查询信息
- **⚡ 重试机制** - 自动重试失败的 API 请求
- **📋 字段管理** - 完整的字段列表和权限说明

## 🖼️ 界面预览

### 主界面
```
┌─────────────────────────────────────────────────────────────┐
│                    FOFA API 图形界面工具                   │
├─────────────────────────────────────────────────────────────┤
│ [API密钥] ____________________________________ [保存密钥]   │
│ [查询语句] ________________________________________________ │
│ [每页数量] ____ [预览查询] [获取全量数据] [导出CSV]        │
│ [批量模式] [查看字段说明] [状态: 准备就绪]                │
├─────────────────────────────────────────────────────────────┤
│ [搜索字段] _______________ [全选/反选]                    │
│ □ host                    □ ip                    □ port   │
│ □ protocol                □ country               □ ...    │
│ □ title                   □ domain                □ ...    │
│ ... (更多字段)                                              │
└─────────────────────────────────────────────────────────────┘
```

### 查询结果界面
```
┌─────────────────────────────────────────────────────────────┐
│                         查询结果                            │
├─────────────────────────────────────────────────────────────┤
│ 查询信息:                                                   │
│   • 查询语句: title="北京日报"                             │
│   • 查询字段: host,ip,port                                 │
│   • 总结果数: 1250                                         │
│   • 消耗F点: 1                                             │
├─────────────────────────────────────────────────────────────┤
│ 序号 | host         | ip           | port | ...            │
│ 1    | example.com  | 192.168.1.1  | 80   | ...            │
│ 2    | test.com     | 192.168.1.2  | 443  | ...            │
│ ...  | ...          | ...          | ...  | ...            │
└─────────────────────────────────────────────────────────────┘
```

## 📋 系统要求

- **操作系统**: Windows 10/11, macOS 10.14+, Linux
- **Python**: 3.8 或更高版本
- **内存**: 至少 4GB RAM
- **网络**: 稳定的互联网连接

## 🚀 快速开始

### 1. 克隆项目
```bash
git clone https://github.com/your-username/fofa-flet.git
cd fofa-flet
```

### 2. 安装依赖
```bash
pip install -r requirements.txt
```

### 3. 运行应用
```bash
# 桌面应用模式
python fofa.py

# 或者启动为 Web 应用
python fofa.py web
```

## 📦 依赖包

项目依赖以下 Python 包：

```txt
flet>=0.26.0
requests>=2.31.0
cryptography>=41.0.0
```

## ⚙️ 配置说明

### API 密钥配置

1. 获取 FOFA API 密钥：登录 [FOFA官网](https://fofa.info/)，进入个人中心获取 API 密钥
2. 在应用中输入 API 密钥
3. 点击"保存密钥"加密存储（可选）

### 加密配置

**重要**: 生产环境请修改默认加密参数：

```python
# 在 fofa.py 文件顶部修改以下配置
SALT = b'your_16_bytes_random_salt'  # 16字节随机盐值
PASSWORD = b'your_strong_password_here'  # 强密码
```

## 🔧 使用指南

### 基本查询

1. **输入 API 密钥** - 在顶部输入框中输入您的 FOFA API 密钥
2. **编写查询语句** - 使用 FOFA 语法编写查询条件
   ```
   title="北京日报"
   domain="gov.cn" && port="443"
   ip="192.168.1.0/24"
   ```

3. **选择查询字段** - 在右侧面板选择需要的字段
4. **预览查询** - 点击"预览查询"查看前10条结果
5. **获取全量数据** - 确认数据量后获取完整数据
6. **导出 CSV** - 将数据导出为 CSV 文件

### 批量模式

支持同时处理多个查询语句：

1. 点击"批量模式"按钮
2. 在对话框中每行输入一个查询语句
3. 点击"预览"查看每个查询的数据量
4. 点击"导出"批量导出所有查询结果

### 字段说明

应用内置完整的字段说明：

| 字段名 | 描述 | 权限要求 |
|--------|------|----------|
| `ip` | IP地址 | 无 |
| `port` | 端口 | 无 |
| `host` | 主机名 | 无 |
| `title` | 网站标题 | 无 |
| `domain` | 域名 | 无 |
| ... | ... | ... |

## 🗂️ 文件结构

```
fofa_flet/
├── fofa.py              # 主程序文件
├── key.enc              # 加密的API密钥文件（自动生成）
├── fofa_results/         # 导出的CSV文件目录
│   ├── fofa_search_20241201_143022_123456.csv
│   └── ...
├── fofa_gui.log         # 应用日志文件
├── requirements.txt     # 依赖包列表
└── README.md           # 本文档
```

## 🐛 故障排除

### 常见问题

**Q: 应用无法启动**
A: 检查 Python 版本和依赖包是否正确安装

**Q: API 请求失败**
A: 检查网络连接和 API 密钥有效性

**Q: 数据导出失败**
A: 检查磁盘空间和文件写入权限

### 日志文件

应用会在当前目录生成 `fofa_gui.log` 文件，包含详细的运行日志。

## 📞 支持

如有问题，请通过以下方式联系：
- 提交 [GitHub Issue](https://github.com/SecureInsights/fofa-flet/issues)
- 查看项目文档

---

**注意**: 本项目仅供学习和合法安全测试使用，请遵守相关法律法规和 FOFA 平台的使用条款。
